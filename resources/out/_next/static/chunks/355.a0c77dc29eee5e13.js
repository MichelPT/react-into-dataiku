"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{1355:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(5155),s=a(2115),l=a(2577),n=a(1154),d=a(5695),i=a(9509);let o=e=>{let t=t=>Object.fromEntries(e.map(e=>[e,t])),a=new Set(["SLIDING_WINDOW","GR","DENS","NEUT","RES"]),r={SLIDING_WINDOW:100,GR:"GR",DENS:"RHOB",NEUT:"NPHI",RES:"RT"};return[{id:1,location:"Constant",mode:"Input",comment:"window wide of sliding average",unit:"METRES",name:"SLIDING_WINDOW",isEnabled:!0},{id:3,location:"Log",mode:"Input",comment:"Input gamma ray log",unit:"GAPI",name:"GR",isEnabled:!0},{id:4,location:"Log",mode:"Input",comment:"Input density log",unit:"G/C3",name:"DENS",isEnabled:!0},{id:5,location:"Log",mode:"Input",comment:"Input neutron log",unit:"V/V",name:"NEUT",isEnabled:!0},{id:6,location:"Log",mode:"Input",comment:"Input resistivity log",unit:"OHMM",name:"RES",isEnabled:!0}].filter(e=>a.has(e.name)).map(e=>({...e,values:t(r[e.name]||"")}))};function c(){let{selectedWells:e,selectedIntervals:t,wellColumns:a}=(0,l.M)(),[c,m]=(0,s.useState)([]),p=(0,d.useRouter)(),[u,b]=(0,s.useState)(!1),[x,h]=(0,s.useState)({});(0,s.useEffect)(()=>{m(o(t))},[t]);let g=e.flatMap(e=>a[e]||[]),f=(e,t,a)=>{m(r=>r.map(r=>{if(r.id!==e)return r;if(x[e]){let e=Object.fromEntries(Object.keys(r.values).map(e=>[e,a]));return{...r,values:e}}return{...r,values:{...r.values,[t]:a}}}))},y=(e,t)=>{h(a=>({...a,[e]:t}))},N=async a=>{a.preventDefault(),b(!0);let r={params:c.filter(e=>e.isEnabled).reduce((e,a)=>{let r=a.values[t[0]||"default"]||a.values[Object.keys(a.values)[0]];return e[a.name]=r,e},{}),selected_wells:e,selected_intervals:t};console.log("Payload yang dikirim ke backend:",r);let s=i.env.NEXT_PUBLIC_API_URL;try{let e=await fetch("".concat(s,"/api/run-gsa-calculation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){let t=await e.json();throw Error(t.error||"Server error")}let t=await e.json();alert(t.message||"Proses kalkulasi RGSA, NGSA, DGSA berhasil!"),p.push("/dashboard")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{b(!1)}},w=(e,t)=>{switch(e){case"Parameter":return"bg-orange-600";case"Constant":if("Input"===t)return"bg-yellow-300";return"bg-yellow-100";case"Log":if("Input"===t)return"bg-cyan-400";return"bg-cyan-200";case"Output":return"bg-yellow-600";case"Interval":return"bg-green-400";default:return"bg-white"}};return(0,r.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Computer reference logs for depth matching."}),(0,r.jsxs)("form",{onSubmit:N,className:"flex-grow flex flex-col min-h-0",children:[(0,r.jsxs)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-4 items-start",children:(0,r.jsx)("div",{className:"md:col-span-4",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Well: ",e+", "," / Intervals: ",t.length," selected"]})})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t",children:[(0,r.jsx)("button",{type:"button",onClick:()=>p.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700",disabled:u,children:u?(0,r.jsx)(n.A,{className:"animate-spin"}):"Start"})]})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,r.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,r.jsx)("div",{className:"overflow-auto h-full",children:(0,r.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,r.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,r.jsxs)("tr",{children:[["#","Location","Mode","Comment","Unit","Name","P"].map(e=>(0,r.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e)),t.map(e=>(0,r.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e))]})}),(0,r.jsx)("tbody",{className:"bg-white",children:c.map(e=>(0,r.jsxs)("tr",{className:"border-b border-gray-200 ".concat(w(e.location,e.mode)),children:[(0,r.jsx)("td",{className:"px-3 py-2 border-r text-center text-sm",children:e.id}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.location}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.mode}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-normal max-w-xs text-sm",children:e.comment}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.unit}),(0,r.jsx)("td",{className:"px-3 py-2 border-r font-semibold whitespace-nowrap text-sm",children:e.name}),(0,r.jsx)("td",{className:"px-3 py-2 border-r text-center",children:(0,r.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-400",checked:!!x[e.id],onChange:t=>y(e.id,t.target.checked)})}),t.map(t=>{var a;let s=null!=(a=e.values[t])?a:"",l=[];"GR"===e.name?l=g.filter(e=>e.toUpperCase().includes("GR")):"DENS"===e.name?l=g.filter(e=>e.toUpperCase().includes("RHOB")):"NEUT"===e.name?l=g.filter(e=>e.toUpperCase().includes("NPHI")):"RES"===e.name&&(l=g.filter(e=>e.toUpperCase().includes("RT")));let n=["GR","DENS","NEUT","RES"].includes(e.name);return(0,r.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:n?(0,r.jsxs)("select",{value:s,onChange:a=>f(e.id,t,a.target.value),disabled:!e.isEnabled,className:"w-full p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500",children:[0===l.length&&(0,r.jsx)("option",{value:"",children:"No match"}),l.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}):(0,r.jsx)("input",{type:"text",value:s,onChange:a=>f(e.id,t,a.target.value),disabled:!e.isEnabled,className:"w-full min-w-[100px] p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500"})},t)})]},e.id))})]})})})]})]})}}}]);