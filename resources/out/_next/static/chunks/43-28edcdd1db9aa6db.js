"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{688:(e,t,a)=>{a.d(t,{A:()=>m});var l=a(5155),r=a(2115),s=a(2577),n=a(8335),o=a(1154),i=a(1243),c=a(5028),d=a(5695);let u=(0,c.default)(()=>Promise.all([a.e(840),a.e(134),a.e(133)]).then(a.bind(a,1514)),{loadableGenerated:{webpack:()=>[1514]},ssr:!1}),h=e=>{let{label:t,children:a}=e;return(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),a]})};function m(){let{selectedWells:e,selectedIntervals:t,wellColumns:a}=(0,s.M)(),{vshDNParams:c,setVshDNParams:m,vshParams:g,setVshParams:p}=(0,n.m)(),f=(0,d.useSearchParams)(),[x,y]=(0,r.useState)(""),[b,v]=(0,r.useState)(""),[w,N]=(0,r.useState)(null),[j,S]=(0,r.useState)(!1),[_,A]=(0,r.useState)(null),P=(0,r.useMemo)(()=>{if(0===e.length||0===Object.keys(a).length)return[];let t=e.flatMap(e=>a[e]||[]),l=new Set(["MARKER","STRUKTUR","WELL_NAME","DEPTH","DEPT"]);return[...new Set(t)].filter(e=>!l.has(e))},[e,a]),R=(0,r.useCallback)(async(a,l)=>{if(0===e.length||!a||!l)return;S(!0),A(null),N(null);let r={selected_wells:e,selected_intervals:t,x_col:a,y_col:l,...c,...g};try{let e=await fetch("http://127.0.0.1:5001/api/get-crossplot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw Error((await e.json()).error||"Gagal mengambil data");N(await e.json())}catch(e){A(e instanceof Error?e.message:"Terjadi kesalahan")}finally{S(!1)}},[e,t,c,g]);(0,r.useEffect)(()=>{let e=f.get("x"),t=f.get("y");e&&t?(y(e),v(t),R(e,t)):P.length>0&&(y("NPHI"),v("RHOB"))},[f,R,P]);let E=(e,t)=>{let a=parseFloat(t);m({...c,[e]:isNaN(a)?"":a})},k=(e,t)=>{let a=parseFloat(t);p({...g,[e]:isNaN(a)?"":a})};return(0,l.jsxs)("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow-md",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:["Crossplot ",b||""," vs ",x||""]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Wells: ",e.join(", ")||"N/A"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Intervals: ",t.join(", ")||"All"]}),(0,l.jsx)("div",{className:"p-4 border rounded-lg bg-gray-50 space-y-4 mb-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["NPHI"===x&&"RHOB"===b&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{label:"Percentile Quartz",children:(0,l.jsx)("input",{type:"number",value:c.prcnt_qz,onChange:e=>E("prcnt_qz",e.target.value),className:"w-full p-2 border rounded-md",step:"any"})}),(0,l.jsx)(h,{label:"Percentile Water",children:(0,l.jsx)("input",{type:"number",value:c.prcnt_wtr,onChange:e=>E("prcnt_wtr",e.target.value),className:"w-full p-2 border rounded-md",step:"any"})})]}),"NPHI"===x&&("GR"===b||"GR_RAW_NORM"===b)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{label:"GR MA",children:(0,l.jsx)("input",{type:"number",value:g.gr_ma,onChange:e=>k("gr_ma",e.target.value),className:"w-full p-2 border rounded-md",step:"any"})}),(0,l.jsx)(h,{label:"GR SH",children:(0,l.jsx)("input",{type:"number",value:g.gr_sh,onChange:e=>k("gr_sh",e.target.value),className:"w-full p-2 border rounded-md",step:"any"})})]})]})}),(0,l.jsxs)("div",{className:"mt-4 min-h-[600px] border-2 border-dashed rounded-lg flex items-center justify-center p-2",children:[j&&(0,l.jsxs)("div",{className:"text-center text-gray-500",children:[(0,l.jsx)(o.A,{className:"animate-spin h-8 w-8 mx-auto mb-2"}),"Generating plot..."]}),_&&(0,l.jsxs)("div",{className:"text-center text-red-600 p-4",children:[(0,l.jsx)(i.A,{className:"mx-auto h-8 w-8 mb-2"}),"Error: ",_]}),!j&&!_&&w&&(0,l.jsx)(u,{data:w.data,layout:{...w.layout,autosize:!0},style:{width:"100%",height:"100%"},config:{responsive:!0},useResizeHandler:!0}),!j&&!_&&!w&&(0,l.jsx)("div",{className:"text-center text-gray-400",children:'Select axes and click "Generate Crossplot" or choose a predefined crossplot from the sidebar.'})]})]})}},2577:(e,t,a)=>{a.d(t,{M:()=>i,q:()=>o});var l=a(5155),r=a(2115),s=a(9509);let n=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[g,p]=(0,r.useState)("default"),[f,x]=(0,r.useState)({}),[y,b]=(0,r.useState)({data:[],layout:{}}),[v,w]=(0,r.useState)(null),[N,j]=(0,r.useState)(!0),[S,_]=(0,r.useState)(null),A=s.env.NEXT_PUBLIC_API_URL;(0,r.useEffect)(()=>{let e=s.env.NEXT_PUBLIC_API_URL;(async()=>{try{if(!e)throw Error("API URL is not configured.");let t="".concat(e,"/api/list-wells");console.log("Fetching available wells from server: ".concat(t));let a=await fetch(t);if(!a.ok)throw Error("Network response from /api/list-wells was not ok");let l=await a.json();Array.isArray(l)&&o(l)}catch(e){console.error("Failed to fetch well list from server:",e)}try{let e=await fetch("http://127.0.0.1:5001/api/list-intervals");if(!e.ok)throw Error("Gagal mengambil daftar interval");let t=await e.json();Array.isArray(t)&&c(t)}catch(e){console.error("Error fetching intervals:",e)}})()},[]),(0,r.useCallback)(async()=>{if(0===d.length||!A){b({data:[],layout:{title:{text:"Please select a well to begin."}}}),j(!1);return}j(!0),_(null);try{let e=await fetch("".concat(A,"/api/get-plot"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selected_wells:d,selected_intervals:h})});if(!e.ok){let t=await e.json();throw Error(t.error||"Network response was not ok")}let t=await e.json();b(t)}catch(e){console.error("Failed to fetch plot data:",e),_(e instanceof Error?e.message:"An unknown error occurred"),b({data:[],layout:{}})}finally{j(!1)}},[d,h,A]);let P=async e=>{try{let t=await fetch("".concat(A,"/api/get-well-columns"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wells:e})});if(!t.ok)throw Error("Network error saat ambil kolom well");let a=await t.json();x(a)}catch(e){console.error("Gagal mengambil kolom well:",e)}};(0,r.useEffect)(()=>{d.length>0&&P(d)},[d]);let R={availableWells:a,selectedWells:d,toggleWellSelection:e=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},selectedIntervals:h,toggleInterval:e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},plotType:g,setPlotType:p,wellColumns:f,fetchWellColumns:P,plotFigure:y,setPlotFigure:b,selectedFilePath:v,setSelectedFilePath:w,isLoading:N,error:S,getCurrentLogs:()=>{console.log("Getting current logs from plot data:",y.data);let e=y.data.filter(e=>"scattergl"===e.type&&e.name&&!e.name.toLowerCase().includes("xover")&&"MARKER"!==e.name);console.log("Found log curves:",e.map(e=>e.name));let t=[];for(let a of e)if(a.name)try{let e=[],l=[];if(a.x&&a.x._inputArray instanceof Float64Array?e=Array.from(a.x._inputArray):Array.isArray(a.x)?e=a.x:a.x&&Array.isArray(a.x.data)&&(e=a.x.data),a.y&&a.y._inputArray instanceof Float64Array?l=Array.from(a.y._inputArray):Array.isArray(a.y)?l=a.y:a.y&&Array.isArray(a.y.data)&&(l=a.y.data),0===e.length||0===l.length){console.log("No valid data arrays for log ".concat(a.name));continue}let r=[];for(let t=0;t<l.length;t++){let a=Number(l[t]),s=e[t],n=null!=s?Number(s):null;isNaN(a)||null!==n&&isNaN(n)||r.push([a,n])}if(0===r.length){console.log("No valid data points found for log ".concat(a.name));continue}console.log("Processed ".concat(r.length," points for log ").concat(a.name)),t.push({curveName:a.name,data:r,wellName:d[0]||"Unknown Well",plotData:y.data})}catch(e){console.error("Error processing log ".concat(a.name,": ").concat(e))}return console.log("Transformed logs:",t),t},availableIntervals:i,plotData:y.data,setPlotData:e=>b(t=>({...t,data:e}))};return(0,l.jsx)(n.Provider,{value:R,children:t})},i=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useDashboard must be used within a DashboardProvider");return e}},4618:(e,t,a)=>{a.d(t,{A:()=>d});var l=a(5155),r=a(2115),s=a(2577),n=a(1154),o=a(1243);let i=(0,a(5028).default)(()=>Promise.all([a.e(840),a.e(134),a.e(133)]).then(a.bind(a,1514)),{loadableGenerated:{webpack:()=>[1514]},ssr:!1}),c=e=>{let{label:t,children:a}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),a]})};function d(){let{selectedWells:e,wellColumns:t,fetchWellColumns:a,selectedIntervals:d}=(0,s.M)(),[u,h]=(0,r.useState)(""),[m,g]=(0,r.useState)(!1),[p,f]=(0,r.useState)(null),[x,y]=(0,r.useState)(null),b=(0,r.useMemo)(()=>{if(0===e.length||0===Object.keys(t).length)return[];let a=new Set(t[e[0]]||[]);for(let l=1;l<e.length;l++){let r=new Set(t[e[l]]||[]);a=new Set([...a].filter(e=>r.has(e)))}let l=new Set(["MARKER","STRUKTUR","WELL_NAME","SP","DEPTH","CALI"]);return Array.from(a).filter(e=>!l.has(e))},[e,t]);(0,r.useEffect)(()=>{0!==e.length&&(e.every(e=>{var a;return(null==(a=t[e])?void 0:a.length)>0})||a(e))},[e,t,a]),(0,r.useEffect)(()=>{b.length>0&&!b.includes(u)?h(b[0]):0===b.length&&h("")},[b,u]);let v=async t=>{if(t.preventDefault(),!u)return void alert("Please select a log to analyze.");g(!0),y(null),f(null);try{let t=await fetch("http://127.0.0.1:5001/api/get-histogram-plot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selected_wells:e,log_column:u,selected_intervals:d})});if(!t.ok)throw Error((await t.json()).error||"Server error");let a=JSON.parse(await t.json());f(a)}catch(e){y(e instanceof Error?e.message:"An unknown error occurred")}finally{g(!1)}};return(0,l.jsxs)("div",{className:"p-4 md:p-8 min-h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800 flex-shrink-0",children:"Histogram Analysis"}),(0,l.jsxs)("form",{onSubmit:v,className:"flex-shrink-0",children:[(0,l.jsxs)("div",{className:"p-4 border rounded-lg bg-gray-50 space-y-4",children:[(0,l.jsxs)("p",{className:"text-sm font-semibold",children:["Wells Selected: ",e.join(", ")||"N/A"," / Intervals: ",d.length," selected"]}),(0,l.jsx)("hr",{}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,l.jsx)(c,{label:"Select Log to Analyze",children:(0,l.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md shadow-sm",disabled:0===b.length,children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Select a log..."}),b.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})})})]}),(0,l.jsx)("div",{className:"flex justify-end gap-2 pt-4 mt-4 border-t",children:(0,l.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white bg-blue-600 font-semibold",disabled:m||0===e.length,children:m?(0,l.jsx)(n.A,{className:"animate-spin"}):"Generate"})})]}),(0,l.jsx)("div",{className:"flex justify-center items-center mt-6",children:(0,l.jsxs)("div",{className:"w-full aspect-square border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center p-4",children:[m&&(0,l.jsxs)("div",{className:"text-center text-gray-500",children:[(0,l.jsx)(n.A,{className:"animate-spin h-8 w-8 mx-auto mb-2"}),"Generating plot..."]}),x&&(0,l.jsxs)("div",{className:"text-center text-red-600 p-4",children:[(0,l.jsx)(o.A,{className:"mx-auto h-8 w-8 mb-2"}),"Error: ",x]}),!m&&!x&&p&&(0,l.jsx)(i,{data:p.data,layout:p.layout,style:{width:"100%",height:"100%"},config:{responsive:!0},useResizeHandler:!0}),!m&&!x&&!p&&(0,l.jsx)("div",{className:"text-center text-gray-400",children:"Histogram will be displayed here."})]})})]})}},8335:(e,t,a)=>{a.d(t,{m:()=>s});var l=a(5453),r=a(6786);let s=(0,l.v)()((0,r.Zr)((e,t)=>({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},selectedWell:"",selectedIntervals:[],plotData:[],plotLayout:{},isLoadingPlot:!0,plotError:null,vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5},setStagedStructure:t=>e({stagedStructure:t}),setQcResults:t=>e({qcResults:t}),addHandledFile:t=>e(e=>({handledFiles:[...e.handledFiles,t]})),addNormalizationResult:(t,a)=>e(e=>({normalizationResults:{...e.normalizationResults,[t]:a}})),clearQcResults:()=>e({qcResults:null,handledFiles:[]}),clearNormalizationResults:()=>e({normalizationResults:{}}),clearAllData:()=>e({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5}}),setSelectedWell:a=>{e({selectedWell:a}),t().fetchPlotData(a)},toggleInterval:t=>e(e=>({selectedIntervals:e.selectedIntervals.includes(t)?e.selectedIntervals.filter(e=>e!==t):[...e.selectedIntervals,t]})),setVshParams:t=>e({vshParams:t}),setVshDNParams:t=>e({vshDNParams:t}),fetchPlotData:async e=>{}}),{name:"app-data-storage",partialize:e=>({selectedWell:e.selectedWell,selectedIntervals:e.selectedIntervals,vshParams:e.vshParams,vshDNParams:e.vshDNParams}),storage:(0,r.KU)(()=>localStorage)}))}}]);