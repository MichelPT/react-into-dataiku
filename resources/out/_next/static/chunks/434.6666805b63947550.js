"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[434],{6434:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var n=t(5155),l=t(2115),r=t(2577),s=t(1154),o=t(5695),i=t(9509);let d=e=>{let a=a=>Object.fromEntries(e.map(e=>[e,a])),t=new Set(["NORMALIZE_OPT","LOG_IN","LOG_OUT","LOW_REF","HIGH_REF","LOW_IN","HIGH_IN"]),n={NORMALIZE_OPT:"MIN-MAX",LOG_IN:"GR",LOW_REF:40,HIGH_REF:140,LOW_IN:5,HIGH_IN:95};return n.LOG_OUT="".concat(n.LOG_IN,"_NO"),[{id:1,location:"Parameter",mode:"Input",comment:"Normalization: Min-Max",unit:"ALPHA*15",name:"NORMALIZE_OPT",isEnabled:!0},{id:2,location:"Constant",mode:"Input",comment:"Input low log value",unit:"",name:"LOW_IN",isEnabled:!0},{id:3,location:"Constant",mode:"Input",comment:"Input high log value",unit:"",name:"HIGH_IN",isEnabled:!0},{id:4,location:"Constant",mode:"Input",comment:"Reference log low value",unit:"",name:"LOW_REF",isEnabled:!0},{id:5,location:"Constant",mode:"Input",comment:"Reference log high value",unit:"",name:"HIGH_REF",isEnabled:!0},{id:6,location:"Log",mode:"Input",comment:"Input Log",unit:"LOG_IN",isEnabled:!0,name:"LOG_IN"},{id:7,location:"Log",mode:"Output",comment:"Output Log Name",unit:"LOG_OUT",name:"LOG_OUT",isEnabled:!0}].filter(e=>t.has(e.name)).map(e=>({...e,values:a(n[e.name]||"")}))};function c(){var e;let{selectedWells:a,selectedIntervals:t}=(0,r.M)(),[c,m]=(0,l.useState)([]),u=(0,o.useRouter)(),[b,p]=(0,l.useState)(!1),[h,g]=(0,l.useState)({}),[x,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t.length>0&&m(d(t))},[t]),(0,l.useEffect)(()=>{let e=async e=>{if(0===a.length||!e)return;N(!0);let n=i.env.NEXT_PUBLIC_API_URL;try{let l=await fetch("".concat(n,"/api/get-log-percentiles"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selected_wells:a,selected_intervals:t,log_column:e})});if(!l.ok)return void console.error("Gagal mengambil nilai persentil default dari backend.");let r=await l.json();m(e=>e.map(e=>{let a={...e.values};return Object.keys(a).forEach(t=>{"LOW_IN"===e.name&&(a[t]=r.p5),"HIGH_IN"===e.name&&(a[t]=r.p95)}),{...e,values:a}}))}catch(e){console.error("Error saat fetching percentiles:",e)}finally{N(!1)}},n=c.find(e=>"LOG_IN"===e.name),l=t[0],r=l?null==n?void 0:n.values[l]:void 0;r&&e(r)},[a,t,null==(e=c.find(e=>"LOG_IN"===e.name))?void 0:e.values[t[0]||""]]);let f=(e,a,t)=>{m(n=>n.map(n=>{if(n.id!==e)return n;if(h[e]){let e=Object.fromEntries(Object.keys(n.values).map(e=>[e,a]));return{...n,values:e}}return{...n,values:{...n.values,[t]:a}}}))},y=(e,a)=>{g(t=>({...t,[e]:a}))},w=async e=>{e.preventDefault(),p(!0);let n={params:c.filter(e=>e.isEnabled).reduce((e,a)=>{let n=t[0]||Object.keys(a.values)[0],l=a.values[n];return e[a.name]=l,e},{}),selected_wells:a,selected_intervals:t};console.log("Payload yang dikirim ke backend:",n);let l=i.env.NEXT_PUBLIC_API_URL;try{let e=await fetch("".concat(l,"/api/run-interval-normalization"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){let a=await e.json();throw Error(a.error||"Server error")}let a=await e.json();console.log("Data yang sudah dinormalisasi diterima:",JSON.parse(a.data)),alert(a.message+" Hasilnya ada di console (F12)."),u.push("/dashboard")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{p(!1)}},v=(e,a)=>{switch(e){case"Parameter":return"bg-orange-600";case"Constant":return"Input"===a?"bg-yellow-300":"bg-yellow-100";case"Log":return"Input"===a?"bg-cyan-400":"bg-cyan-200";case"Output":return"bg-yellow-600";case"Interval":return"bg-green-400";default:return"bg-white"}};return(0,n.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Normalize a log based on calibration parameters."}),(0,n.jsxs)("form",{onSubmit:w,className:"flex-grow flex flex-col min-h-0",children:[(0,n.jsxs)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50",children:[(0,n.jsx)("div",{className:"md:col-span-4",children:(0,n.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Well: ",a.join(", ")||"N/A"," / Intervals: ",t.length," selected"]})}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t",children:[(0,n.jsx)("button",{type:"button",onClick:()=>u.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700 flex items-center justify-center",disabled:b||x,children:b||x?(0,n.jsx)(s.A,{className:"animate-spin"}):"Start"})]})]}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,n.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,n.jsx)("div",{className:"overflow-auto h-full",children:(0,n.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,n.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,n.jsxs)("tr",{children:[["Location","Mode","Comment","Unit","Name","P"].map(e=>(0,n.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e)),t.map(e=>(0,n.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e))]})}),(0,n.jsx)("tbody",{className:"bg-white",children:c.map(e=>(0,n.jsxs)("tr",{className:"border-b border-gray-200 ".concat(e.isEnabled?v(e.location,e.mode):"bg-gray-100 text-gray-400"),children:[(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.location}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.mode}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-normal max-w-xs text-sm",children:e.comment}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap text-sm",children:e.unit}),(0,n.jsx)("td",{className:"px-3 py-2 border-r font-semibold whitespace-nowrap text-sm",children:e.name}),(0,n.jsx)("td",{className:"px-3 py-2 border-r text-center",children:(0,n.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-400",checked:!!h[e.id],onChange:a=>y(e.id,a.target.checked)})}),t.map(a=>{var t,l;return(0,n.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:"NORMALIZE_OPT"===e.name?(0,n.jsx)("select",{value:null!=(t=e.values[a])?t:"",onChange:t=>f(e.id,t.target.value,a),className:"w-full p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500",children:(0,n.jsx)("option",{value:"MIN-MAX",children:"MIN-MAX"})}):(0,n.jsx)("input",{type:"text",value:null!=(l=e.values[a])?l:"",onChange:t=>f(e.id,t.target.value,a),className:"w-full min-w-[100px] p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500"})},a)})]},e.id))})]})})})]})]})}}}]);