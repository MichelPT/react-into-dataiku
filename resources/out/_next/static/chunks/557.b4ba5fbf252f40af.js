"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{8557:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var n=a(5155),r=a(2115),s=a(5695),l=a(2577),o=a(1154),i=a(9509);let c=e=>{let t=t=>Object.fromEntries(e.map(e=>[e,t])),a={RHOB_FL:1,RHOB_SH:2.45,RHOB_DSH:2.6,NPHI_SH:.35,PHIE_MAX:.3,RHOB_MA_BASE:2.65,RHOB_W:1,RHOB_MAX:4};return[{id:1,location:"Constant",mode:"Input",comment:"Fluid Density (e.g., 1.00 for water)",unit:"g/cc",name:"RHOB_FL",isEnabled:!0},{id:2,location:"Constant",mode:"Input",comment:"Shale Density",unit:"g/cc",name:"RHOB_SH",isEnabled:!0},{id:3,location:"Constant",mode:"Input",comment:"Dry Shale Density",unit:"g/cc",name:"RHOB_DSH",isEnabled:!0},{id:4,location:"Constant",mode:"Input",comment:"Shale Neutron Porosity",unit:"v/v",name:"NPHI_SH",isEnabled:!0},{id:5,location:"Constant",mode:"Input",comment:"Maximum allowed PHIE",unit:"v/v",name:"PHIE_MAX",isEnabled:!0},{id:6,location:"Constant",mode:"Input",comment:"Base Rock Matrix Density (Sandstone)",unit:"kg/m3",name:"RHOB_MA_BASE",isEnabled:!0},{id:7,location:"Constant",mode:"Input",comment:"Water Density",unit:"g/cc",name:"RHOB_W",isEnabled:!0},{id:8,location:"Constant",mode:"Input",comment:"Max Extreme Density (Sandstone)",unit:"kg/m3",name:"RHOB_MAX",isEnabled:!0}].map(e=>({...e,values:t(a[e.name]||"")}))};function d(){let{selectedWells:e,selectedIntervals:t}=(0,l.M)(),a=(0,s.useRouter)(),[d,m]=(0,r.useState)([]),[u,b]=(0,r.useState)(!1),[p,h]=(0,r.useState)({}),[x,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t.length>0?m(c(t)):m([])},[t]),(0,r.useEffect)(()=>{(async()=>{if(0===e.length)return;g(!0);let a=i.env.NEXT_PUBLIC_API_URL;try{let n=await fetch("".concat(a,"/api/get-intersection-point"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selected_wells:e,selected_intervals:t})});if(!n.ok){let e=await n.json();console.error("Gagal mengambil nilai default dari intersection point:",e.error);return}let r=await n.json();m(e=>e.map(e=>{if("RHOB_SH"===e.name||"NPHI_SH"===e.name){let t="RHOB_SH"===e.name?r.rhob_sh:r.nphi_sh,a=Object.fromEntries(Object.keys(e.values).map(e=>[e,t]));return{...e,values:a}}return e}))}catch(e){console.error("Error saat fetching intersection defaults:",e)}finally{g(!1)}})()},[e,t]);let y=(e,t,a)=>{m(n=>n.map(n=>{if(n.id!==e)return n;if(p[e]){let e=Object.fromEntries(Object.keys(n.values).map(e=>[e,a]));return{...n,values:e}}return{...n,values:{...n.values,[t]:a}}}))},f=(e,t)=>{h(a=>({...a,[e]:t}))},w=async n=>{n.preventDefault(),b(!0);let r=d.filter(e=>e.isEnabled).reduce((e,a)=>{var n,r;let s=t[0]||"default",l=null!=(r=null!=(n=a.values[s])?n:a.values.default)?r:"";return e[a.name]=isNaN(Number(l))?l:Number(l),e},{}),s=i.env.NEXT_PUBLIC_API_URL;try{let n=await fetch("".concat(s,"/api/run-porosity-calculation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({params:r,selected_wells:e,selected_intervals:t})});if(!n.ok){let e=await n.json();throw Error(e.error||"Server error")}let l=await n.json();alert(l.message||"Proses kalkulasi Porositas berhasil!"),a.push("/dashboard")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{b(!1)}},N=(e,t)=>{switch(e){case"Parameter":return"bg-orange-600";case"Constant":if("Input"===t)return"bg-yellow-300";return"bg-yellow-100";case"Log":if("Input"===t)return"bg-cyan-400";return"bg-cyan-200";case"Output":return"bg-yellow-600";case"Interval":return"bg-green-400";default:return"bg-white"}};return(0,n.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Porosity from density-neutron using Bateman/Konen method"}),(0,n.jsxs)("form",{onSubmit:w,className:"flex-grow flex flex-col min-h-0",children:[(0,n.jsxs)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50 flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"md:col-span-4",children:(0,n.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Well: ",e.join(", ")||"N/A"," / Intervals: ",t.length," selected"]})}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t",children:[(0,n.jsx)("button",{type:"button",onClick:()=>a.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700 flex items-center justify-center min-w-[80px]",disabled:u||x,children:u||x?(0,n.jsx)(o.A,{className:"animate-spin"}):"Start"})]})]}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,n.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,n.jsx)("div",{className:"overflow-auto h-full",children:(0,n.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,n.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,n.jsxs)("tr",{children:[["#","Location","Mode","Comment","Unit","Name","P"].map(e=>(0,n.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e)),t.map(e=>(0,n.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e))]})}),(0,n.jsx)("tbody",{className:"bg-white",children:d.map(e=>(0,n.jsxs)("tr",{className:"border-b border-gray-200 ".concat(e.isEnabled?N(e.location,e.mode):"bg-gray-100 text-gray-400"),children:[(0,n.jsx)("td",{className:"px-3 py-2 border-r text-center",children:e.id}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:e.location}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:e.mode}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-normal max-w-xs",children:e.comment}),(0,n.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:e.unit}),(0,n.jsx)("td",{className:"px-3 py-2 border-r font-semibold whitespace-nowrap",children:e.name}),(0,n.jsx)("td",{className:"px-3 py-2 border-r text-center",children:(0,n.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-400",checked:!!p[e.id],onChange:t=>f(e.id,t.target.checked)})}),t.map(t=>{var a;return(0,n.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:(0,n.jsx)("input",{type:"text",value:null!=(a=e.values[t])?a:"",onChange:a=>y(e.id,t,a.target.value),className:"w-full min-w-[100px] p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500"})},t)})]},e.id))})]})})})]})]})}}}]);