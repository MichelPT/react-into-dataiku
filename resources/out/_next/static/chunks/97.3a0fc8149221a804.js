"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[97],{97:(e,a,t)=>{t.r(a),t.d(a,{default:()=>m});var r=t(5155),l=t(2115),s=t(5695),n=t(2577),d=t(1154),i=t(8335),o=t(9509);let c=()=>{let e=e=>({default:e}),a={OPT_GR:"LINEAR",GR_MA:30,GR_SH:120,GR:"GR",VSH_GR:"VSH_GR"};return[{id:1,location:"Interval",mode:"In_Out",comment:"Option for VSH from gamma ray",unit:"ALPHA*8",name:"OPT_GR",isEnabled:!0},{id:2,location:"Interval",mode:"In_Out",comment:"Gamma ray matrix (clean)",unit:"GAPI",name:"GR_MA",isEnabled:!0},{id:3,location:"Interval",mode:"In_Out",comment:"Gamma ray shale",unit:"GAPI",name:"GR_SH",isEnabled:!0},{id:4,location:"Log",mode:"Input",comment:"Gamma ray log",unit:"GAPI",name:"GR",isEnabled:!0},{id:5,location:"Log",mode:"Output",comment:"VSH from gamma ray",unit:"V/V",name:"VSH_GR",isEnabled:!0}].map(t=>({...t,values:e(a[t.name]||"")}))};function m(){let{selectedIntervals:e,selectedWells:a,wellColumns:t}=(0,n.M)(),m=(0,s.useRouter)(),[u,b]=(0,l.useState)([]),[h,p]=(0,l.useState)(!1),[x,g]=(0,l.useState)({}),{setVshParams:y}=(0,i.m)();(0,l.useEffect)(()=>{b(c())},[]);let f=a.flatMap(e=>t[e]||[]),N=(e,a,t)=>{b(r=>r.map(r=>{if(r.id!==e)return r;if(x[e]){let e=Object.fromEntries(Object.keys(r.values).map(e=>[e,t]));return{...r,values:e}}return{...r,values:{...r.values,[a]:t}}}))},v=(e,a)=>{g(t=>({...t,[e]:a}))},w=async t=>{t.preventDefault(),p(!0);let r=u.filter(e=>e.isEnabled).reduce((a,t)=>{let r=t.values[e[0]||"default"]||t.values[Object.keys(t.values)[0]];return a[t.name]=isNaN(Number(r))?r:Number(r),a},{});y({gr_ma:Number(r.GR_MA),gr_sh:Number(r.GR_SH)});let l=o.env.NEXT_PUBLIC_API_URL;try{let t=await fetch("".concat(l,"/api/run-vsh-calculation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({params:r,selected_wells:a,selected_intervals:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Server error")}let s=await t.json();alert(s.message||"Proses kalkulasi VSH berhasil!"),m.push("/dashboard")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{p(!1)}},j=(e,a)=>{switch(e){case"Parameter":return"bg-orange-600";case"Constant":if("Input"===a)return"bg-yellow-300";return"bg-yellow-100";case"Log":if("Input"===a)return"bg-cyan-400";return"bg-cyan-200";case"Output":return"bg-yellow-600";case"Interval":return"bg-green-400";default:return"bg-white"}};return(0,r.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Volume of shale by gamma ray method"}),(0,r.jsxs)("form",{onSubmit:w,className:"flex-grow flex flex-col min-h-0",children:[(0,r.jsxs)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50 flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-4 items-start",children:(0,r.jsx)("div",{className:"md:col-span-4",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Well: ",a+", "," / Intervals: ",e.length," selected"]})})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t",children:[(0,r.jsx)("button",{type:"button",onClick:()=>m.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700",disabled:h,children:h?(0,r.jsx)(d.A,{className:"animate-spin"}):"Start"})]})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,r.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,r.jsx)("div",{className:"overflow-auto h-full",children:(0,r.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,r.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,r.jsxs)("tr",{children:[["#","Location","Mode","Comment","Unit","Name","P"].map(e=>(0,r.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e)),e.map(e=>(0,r.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r border-gray-300 whitespace-nowrap",children:e},e))]})}),(0,r.jsx)("tbody",{className:"bg-white",children:u.map(a=>(0,r.jsxs)("tr",{className:"border-b border-gray-200 ".concat(a.isEnabled?j(a.location,a.mode):"bg-gray-100 text-gray-400"),children:[(0,r.jsx)("td",{className:"px-3 py-2 border-r text-center",children:a.id}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:a.location}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:a.mode}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-normal max-w-xs",children:a.comment}),(0,r.jsx)("td",{className:"px-3 py-2 border-r whitespace-nowrap",children:a.unit}),(0,r.jsx)("td",{className:"px-3 py-2 border-r font-semibold whitespace-nowrap",children:a.name}),(0,r.jsx)("td",{className:"px-3 py-2 border-r text-center",children:(0,r.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-400",checked:!!x[a.id],onChange:e=>v(a.id,e.target.checked)})}),e.map(e=>{var t,l,s,n;return(0,r.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:"OPT_GR"===a.name?(0,r.jsx)("select",{value:String(null!=(l=null!=(t=a.values[e])?t:a.values.default)?l:""),onChange:t=>N(a.id,e,t.target.value),className:"w-full min-w-[100px] p-1 bg-white disabled:bg-gray-100 disabled:text-gray-500",children:(0,r.jsx)("option",{value:"LINEAR",children:"LINEAR"})}):"GR"===a.name?(()=>{var t,l;let s=f.filter(e=>e.toUpperCase().includes("GR"));return(0,r.jsxs)("select",{value:String(null!=(l=null!=(t=a.values[e])?t:a.values.default)?l:""),onChange:t=>N(a.id,e,t.target.value),className:"w-full min-w-[100px] p-1 bg-white disabled:bg-gray-100 disabled:text-gray-500",children:[0===s.length&&(0,r.jsx)("option",{value:"",children:"No match"}),s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})})():(0,r.jsx)("input",{type:"text",value:null!=(n=null!=(s=a.values[e])?s:a.values.default)?n:"",onChange:t=>N(a.id,e,t.target.value),className:"w-full min-w-[100px] p-1 bg-white text-black disabled:bg-gray-100 disabled:text-gray-500"})},"".concat(a.id,"-").concat(e))})]},a.id))})]})})})]})]})}}}]);